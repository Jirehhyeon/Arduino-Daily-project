# 🔌 Arduino HW-020 모터 쉴드 + 12V 선풍기 모터 배선 가이드

## 📋 부품 목록

### 필수 부품
- **Arduino Uno R3** - 메인 컨트롤러
- **HW-020 Motor Driver Shield** (L298P 기반)
- **12V DC 선풍기 모터** (소형, 프로펠러 장착 가능)
- **12V 2A 어댑터** - 외부 전원 공급
- **점퍼선** 20AWG (Male-Female, Male-Male)
- **10kΩ 포텐셔미터** - 속도 제어
- **택트 스위치** - 방향 제어
- **LED 3개** (빨강, 초록, 노랑) - 상태 표시
- **저항 220Ω 3개** - LED 전류 제한

### 선택사항
- **ACS712 전류 센서** - 전류 모니터링
- **LM35 온도 센서** - 온도 감지
- **브레드보드** - 추가 회로 구성

---

## ⚡ 전류 및 전력 계산

### 모터 사양
```
12V 소형 선풍기 모터:
- 정격 전압: 12V DC
- 정격 전류: 0.3-0.8A (일반적)
- 최대 전류: 1.2A (기동 시)
- 정격 파워: 3.6-9.6W
```

### 점퍼선 안전성
```
20AWG 점퍼선:
- 허용 전류: 11A (최대)
- 안전 전류: 2A (연속 사용)
- 모터 전류: 0.8A (정격)
- 안전 마진: 2.5배 (안전함)
```

### HW-020 쉴드 사양
```
L298P 칩 기반:
- 채널당 최대 전류: 2A
- 총 최대 전류: 4A
- 로직 전압: 5V
- 모터 전압: 6-12V
- PWM 주파수: 1kHz
```

**결론: 전류 안전성 확보됨** ✅

---

## 🔧 배선도

### 기본 연결
```
Arduino Uno → HW-020 쉴드
┌─────────────┐    ┌──────────────┐
│ Arduino Uno │    │  HW-020      │
│             │    │  Shield      │
│         D3  │───►│ ENA (PWM)    │
│         D12 │───►│ IN1 (DIR)    │
│         D11 │───►│ ENB (PWM)    │──── (예비용)
│         D13 │───►│ IN2 (DIR)    │──── (예비용)
│             │    │              │
│        VIN  │───►│ VCC (12V)    │◄─── 12V 어댑터
│        GND  │───►│ GND          │◄─── 12V 어댑터 GND
└─────────────┘    └──────────────┘
                           │
                    ┌──────▼──────┐
                    │  12V Motor  │
                    │  Red: +12V  │
                    │  Black: GND │
                    └─────────────┘
```

### 제어 회로 연결
```
Arduino 디지털/아날로그 핀:
┌─────────────┐
│    A0       │◄─── 포텐셔미터 (속도 제어)
│    A1       │◄─── 전류 센서 (선택사항)
│    D2       │◄─── 방향 버튼 (인터럽트)
│    D4       │────► 방향 LED (노랑)
│    D5       │────► 전원 LED (초록)
│    D6       │────► 경고 LED (빨강)
└─────────────┘
```

---

## 📐 상세 배선 지침

### 1. 전원 연결
```bash
12V 어댑터 연결:
1. 12V 어댑터 (+) → HW-020 VCC 터미널
2. 12V 어댑터 (-) → HW-020 GND 터미널
3. Arduino VIN → HW-020 VCC (점퍼선)
4. Arduino GND → HW-020 GND (점퍼선)

⚠️ 주의: Arduino USB 연결 시 12V 어댑터 분리
```

### 2. 모터 연결
```bash
12V 선풍기 모터:
1. 모터 빨강선 → HW-020 OUT1 터미널
2. 모터 검정선 → HW-020 OUT2 터미널
3. 터미널 나사 단단히 조임
4. 선 피복 벗김 최소화 (5mm)
```

### 3. 제어 신호 연결
```bash
점퍼선 연결 (Male-Female):
1. Arduino D3 → HW-020 ENA (PWM 신호)
2. Arduino D12 → HW-020 IN1 (방향 신호)
3. Arduino 5V → 브레드보드 (+) 레일
4. Arduino GND → 브레드보드 (-) 레일
```

### 4. 사용자 인터페이스
```bash
포텐셔미터 (10kΩ):
- 중간핀 → Arduino A0
- 한쪽끝 → 5V
- 다른끝 → GND

방향 버튼:
- 한쪽 → Arduino D2
- 다른쪽 → GND
- 내부 풀업 저항 사용

LED 연결 (각각 220Ω 저항 직렬):
- 방향 LED (노랑): D4 → 저항 → LED → GND
- 전원 LED (초록): D5 → 저항 → LED → GND  
- 경고 LED (빨강): D6 → 저항 → LED → GND
```

### 5. 전류 센서 (선택사항)
```bash
ACS712-05B 전류 센서:
- VCC → 5V
- GND → GND
- OUT → Arduino A1
- IP+ → 모터 (+) 라인 중간에 직렬 연결
- IP- → 모터로 계속 연결
```

---

## 🛡️ 안전 지침

### 전기 안전
1. **전원 분리**: 배선 작업 시 모든 전원 차단
2. **극성 확인**: 12V 어댑터 극성 반드시 확인
3. **단락 방지**: 배선 후 단락 여부 확인
4. **전류 한계**: 모터 전류가 2A 초과하지 않도록 확인

### 기계적 안전
1. **프로펠러 가드**: 회전하는 프로펠러 주변에 보호 장치
2. **고정**: 모터와 Arduino 단단히 고정
3. **환기**: 모터 과열 방지를 위한 충분한 환기

### 소프트웨어 안전
```cpp
// 안전 기능 구현 예시
if (motor_current > SAFETY_LIMIT) {
    digitalWrite(MOTOR_PWM, LOW);  // 즉시 정지
    safety_mode = true;
}

if (temperature > TEMP_LIMIT) {
    gradually_reduce_speed();      // 점진적 감속
}
```

---

## 🔧 조립 순서

### 단계 1: 기본 조립
1. Arduino에 HW-020 쉴드 장착
2. 12V 어댑터 극성 확인
3. 모터 터미널 연결

### 단계 2: 제어 회로
1. 브레드보드에 포텐셔미터 연결
2. 방향 버튼 연결
3. LED 및 저항 연결

### 단계 3: 신호 연결
1. 점퍼선으로 Arduino ↔ 브레드보드 연결
2. PWM, 방향 신호선 연결
3. 아날로그 입력선 연결

### 단계 4: 테스트
1. 연결 확인 (단락 검사)
2. 전원 투입 전 최종 점검
3. 저전압으로 기본 동작 테스트

---

## 📊 핀아웃 요약표

| Arduino 핀 | 연결 대상 | 기능 | 타입 |
|------------|-----------|------|------|
| D3 | HW-020 ENA | 모터 PWM | PWM 출력 |
| D12 | HW-020 IN1 | 모터 방향 | 디지털 출력 |
| A0 | 포텐셔미터 | 속도 제어 | 아날로그 입력 |
| A1 | 전류 센서 | 전류 감지 | 아날로그 입력 |
| D2 | 방향 버튼 | 방향 토글 | 디지털 입력 (인터럽트) |
| D4 | 방향 LED | 상태 표시 | 디지털 출력 |
| D5 | 전원 LED | 상태 표시 | 디지털 출력 |
| D6 | 경고 LED | 경고 표시 | 디지털 출력 |
| VIN | 12V 전원 | 시스템 전원 | 전원 입력 |
| GND | 공통 접지 | 그라운드 | 접지 |

---

## ⚠️ 문제 해결

### 모터가 돌아가지 않을 때
1. **전원 확인**: 12V 어댑터 연결 및 극성
2. **신호 확인**: PWM 신호 (D3) 연결
3. **코드 확인**: `motor.enabled = true` 설정

### 모터가 한 방향으로만 돌 때
1. **방향 신호 확인**: D12 연결 상태
2. **터미널 연결**: OUT1, OUT2 교체 시도
3. **코드 확인**: 방향 로직 검증

### 속도 제어가 안 될 때
1. **포텐셔미터 연결**: A0 핀 연결 확인
2. **전원 공급**: 포텐셔미터에 5V 공급 확인
3. **코드 확인**: PWM 값 매핑 확인

### 과열/과전류 발생 시
1. **전원 차단**: 즉시 전원 분리
2. **연결 점검**: 단락 여부 확인
3. **모터 사양**: 12V 정격 여부 확인

---

## 📈 성능 최적화

### PWM 주파수 조정
```cpp
// 더 부드러운 모터 제어를 위한 고주파 PWM
void setupHighFrequencyPWM() {
    // Timer2 (D3, D11) 31.25kHz로 설정
    TCCR2B = TCCR2B & 0b11111000 | 0x01;
}
```

### 소프트 스타트
```cpp
// 모터 기동 시 부드러운 가속
void softStart() {
    for(int speed = 0; speed <= target_speed; speed += 5) {
        analogWrite(MOTOR_PWM, speed);
        delay(50);
    }
}
```

### 에너지 효율
```cpp
// 저속에서 PWM 주파수 낮춰 효율 향상
if(motor_speed < 100) {
    setPWMFrequency(3, 256);  // 낮은 주파수
} else {
    setPWMFrequency(3, 1);    // 높은 주파수
}
```

---

## 🎯 고급 기능

### 1. 속도 피드백 제어
- **홀 센서** 또는 **엔코더** 추가로 실제 RPM 측정
- **PID 제어**로 정확한 속도 유지

### 2. 무선 제어
- **ESP32**로 업그레이드하여 WiFi 제어
- **블루투스** 모듈 추가로 스마트폰 제어

### 3. 다중 모터 제어
- HW-020 쉴드 2채널 모두 사용
- 다중 선풍기 동기화 제어

### 4. 환경 연동
- **온도 센서**로 자동 속도 조절
- **습도 센서**로 쾌적도 기반 제어

---

이 가이드를 따라하면 안전하고 효율적인 Arduino 기반 선풍기 제어 시스템을 구축할 수 있습니다! 🌟
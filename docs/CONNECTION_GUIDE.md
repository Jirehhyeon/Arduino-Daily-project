# 아두이노 온습도 자동 제어 시스템 연결 가이드

## 🔌 필요한 부품 목록

### 기본 부품
- **아두이노 우노 R3** (1개)
- **DHT22 온습도 센서** (1개)
- **서보모터 SG90** (1개)
- **LED** (1개)
- **저항 220Ω** (1개) - LED용
- **브레드보드** (1개)
- **점퍼 와이어** (수컷-수컷, 수컷-암컷)

### 선택사항
- **10kΩ 풀업 저항** (DHT22 안정성 향상용)
- **전원 어댑터 9V** (외부 전원 공급용)

## 📋 핀 연결 상세 가이드

### DHT22 온습도 센서 연결
```
DHT22 센서 핀 배치 (정면 기준):
[VCC] [DATA] [NC] [GND]
  +     2     X     -
```

| DHT22 핀 | 아두이노 핀 | 설명 |
|----------|-------------|------|
| VCC      | 5V          | 전원 공급 (3.3V~5V) |
| DATA     | 디지털 2번   | 데이터 통신 핀 |
| NC       | 연결 안함    | 사용하지 않음 |
| GND      | GND         | 접지 |

**중요 사항:**
- DHT22는 디지털 통신을 사용하므로 아날로그 핀이 아닌 디지털 핀에 연결
- 데이터 핀과 VCC 사이에 10kΩ 풀업 저항 권장 (선택사항)

### 서보모터 SG90 연결
```
서보모터 와이어 색상:
갈색(Brown) - GND
빨간색(Red) - VCC
주황색(Orange) - 신호선
```

| 서보모터 와이어 | 아두이노 핀 | 설명 |
|----------------|-------------|------|
| 갈색 (GND)     | GND         | 접지 |
| 빨간색 (VCC)   | 5V          | 전원 공급 |
| 주황색 (신호)   | 디지털 9번   | PWM 제어 신호 |

**중요 사항:**
- 서보모터는 PWM 신호로 제어되므로 PWM 지원 핀(~표시) 사용
- 전류 소모가 크므로 외부 전원 공급 권장

### LED 연결
| LED | 아두이노 핀 | 설명 |
|-----|-------------|------|
| 긴 다리 (+)  | 디지털 13번 → 220Ω 저항 | 양극 (애노드) |
| 짧은 다리 (-) | GND | 음극 (캐소드) |

**중요 사항:**
- LED 앞에 반드시 220Ω 저항 연결 (과전류 방지)
- 극성 확인 필수 (긴 다리가 +, 짧은 다리가 -)

## 🔧 브레드보드 배치도

```
     아두이노 우노
    ┌─────────────┐
    │  Digital    │
13  │ ●─────────○ │ ← LED (220Ω 저항 경유)
12  │ ●           │
11  │ ●           │
10  │ ●           │
 9  │ ●─────────○ │ ← 서보모터 신호선 (주황색)
 8  │ ●           │
 7  │ ●           │
 6  │ ●           │
 5  │ ●           │
 4  │ ●           │
 3  │ ●           │
 2  │ ●─────────○ │ ← DHT22 데이터 핀
 1  │ ●           │
 0  │ ●           │
    │             │
GND │ ●─────────○ │ ← 모든 GND 연결
5V  │ ●─────────○ │ ← DHT22, 서보모터 VCC
3V3 │ ●           │
    └─────────────┘
```

## ⚡ 전원 공급 고려사항

### 내장 전원 사용 시
- USB 전원으로 충분 (DHT22: ~2.5mA, 서보모터: ~100-200mA)
- 서보모터 동작 시 순간 전류 증가 주의

### 외부 전원 사용 시 (권장)
- 9V 어댑터 사용
- 서보모터 안정성 향상
- 다중 센서 확장 시 필수

## 🔍 센서별 상세 작동 원리

### DHT22 온습도 센서
**작동 원리:**
- **온도 측정**: NTC 서미스터 사용
  - 온도 상승 → 저항값 감소
  - 저항값 변화를 디지털 신호로 변환
- **습도 측정**: 정전용량식 습도센서 사용
  - 수분 흡수 → 유전상수 변화 → 정전용량 변화
  - 내장 ADC로 디지털 변환

**통신 방식:**
- Single-Wire 디지털 통신 (1-Wire 유사)
- 시작신호 → 응답신호 → 40비트 데이터 전송
- 데이터 구조: [습도 정수][습도 소수][온도 정수][온도 소수][체크섬]

**측정 범위 및 정확도:**
- 온도: -40°C ~ +80°C (±0.5°C)
- 습도: 0% ~ 100% RH (±2% RH)
- 측정 주기: 2초 (최소 간격)

### 서보모터 SG90
**작동 원리:**
- **제어 방식**: PWM (Pulse Width Modulation)
- **제어 신호**: 20ms 주기, 1~2ms 펄스 폭
  - 1ms → 0도
  - 1.5ms → 90도
  - 2ms → 180도

**내부 구조:**
1. **DC 모터**: 실제 회전 담당
2. **기어박스**: 토크 증가, 속도 감소
3. **포텐셔미터**: 현재 위치 피드백
4. **제어회로**: PWM 신호 해석 및 모터 제어

**특징:**
- 위치 제어 정확도: ±1도
- 토크: 1.8kg·cm
- 속도: 0.1초/60도

### LED (Light Emitting Diode)
**작동 원리:**
- **전자-정공 재결합**: PN 접합에서 빛 방출
- **순방향 전압**: 약 2.0V (빨간색 기준)
- **전류 제한**: 220Ω 저항으로 약 15mA로 제한

**계산:**
```
아두이노 출력전압(5V) - LED 순방향전압(2V) = 3V
3V ÷ 220Ω = 13.6mA (안전 범위)
```

## 🤝 센서 간 상호작용

### 시스템 동작 흐름
```
DHT22 측정 → 불쾌지수 계산 → 쾌적도 판단 → 액추에이터 제어
     ↓              ↓              ↓              ↓
  온도/습도      수치화 평가      조건 분기      LED + 서보모터
```

### 쾌적도 판단 알고리즘
**기준값:**
- 최적 온도: 20-26°C
- 최적 습도: 40-60%
- 불쾌지수: 68 이하 (쾌적)

**불쾌지수 공식:**
```
DI = 0.81 × T + 0.01 × H × (0.99 × T - 14.3) + 46.3
T: 온도(°C), H: 습도(%), DI: 불쾌지수
```

### 제어 로직
```cpp
if (온도 적정 && 습도 적정) {
    LED 켜기();
    서보모터 회전();
    Serial.println("쾌적 모드 ON");
} else {
    LED 끄기();
    서보모터 정지();
    Serial.println("환경 개선 필요");
}
```

## 🚨 안전 주의사항

### 전기 안전
- 전원 연결 전 모든 연결 확인
- 단락 방지를 위한 연결 점검
- 습도가 높은 환경에서 사용 금지

### 부품 보호
- DHT22: 급격한 온도 변화 금지
- 서보모터: 강제 회전 금지 (기어 손상)
- LED: 과전류 방지 위한 저항 필수

### 동작 확인
1. 시리얼 모니터 연결 (9600 baud)
2. 센서 값 정상 출력 확인
3. 임계값 근처에서 동작 테스트
4. 모든 액추에이터 정상 작동 확인

## 🔧 문제 해결 가이드

### 흔한 문제들

**DHT22 읽기 오류**
- 연결 확인 (특히 데이터 핀)
- 전원 전압 확인 (3.3V~5V)
- 측정 간격 확인 (최소 2초)

**서보모터 동작 불량**
- PWM 핀 연결 확인 (9번 핀)
- 전원 공급 확인 (5V, 충분한 전류)
- 신호선 연결 확인

**LED 점등 불량**
- 극성 확인 (긴 다리가 +)
- 저항값 확인 (220Ω)
- 연결 확인

### 성능 최적화

**정확도 향상**
- DHT22에 10kΩ 풀업 저항 추가
- 측정 간격을 2초 이상 유지
- 센서 보정 (필요시)

**전력 효율성**
- 불필요한 delay() 최소화
- LED 밝기 조절 (PWM 사용)
- 서보모터 대기 시 전원 차단